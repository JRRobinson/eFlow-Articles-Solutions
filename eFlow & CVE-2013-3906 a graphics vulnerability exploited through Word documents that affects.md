# **eFlow & CVE-2013-3906: a graphics vulnerability exploited through Word documents that affects** #

## **Question / Description** ##

You try to scan in Colour and are not able to do so.


## **Answer / Solution** ##

Long story short:

Microsoft Fixit51004.msi (created by Microsoft to solve exploit: CVE-2013-3906: a graphics vulnerability exploited through Word documents) - [http://blogs.technet.com/b/srd/archive/2013/11/05/cve-2013-3906-a-graphics-vulnerability-exploited-through-word-documents.aspx ](http://blogs.technet.com/b/srd/archive/2013/11/05/cve-2013-3906-a-graphics-vulnerability-exploited-through-word-documents.aspx )
and [https://technet.microsoft.com/library/security/2896666](https://technet.microsoft.com/library/security/2896666) 
Microsoft Fixit51004.msi creates a registry key called HKLM\Software\Microsoft\Gdiplus which has a DWORD value called DisableTIFFCodec, set to 1 - by default.

This prevents any custom code that is based on the .NET Image Class to properly execute if the image is coloured, thus resulting in an "Out of Memory" error and causing the eFlow custom code to crash and this doesn't allow eFlow to actually put the batch through as a collection.

This is a huge problem and can mislead you to have the custom code even changed.

The solution is simply to set the value of the DisableTIFFCodec to 0 or simply remove the value of full registry key.

Amazing but true... This can affect any eFlow version and might be able to drive you crazy...

Ideally (in an ideal world) the eFlow core scan runtime should be able to check if this key exists and if so, it should warn the user that it might not be able to scan properly if scanning is done in colour if this key DisableTIFFCodec is present and set to 0.

Next time you try to scan in colour and are not able to, check this before anything else...





















